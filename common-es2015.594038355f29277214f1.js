(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{B8NW:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var s=i("5uGe");function o(e,t=!1){return i=>i.lift(new n(e,t))}class n{constructor(e,t){this.predicate=e,this.inclusive=t}call(e,t){return t.subscribe(new r(e,this.predicate,this.inclusive))}}class r extends s.a{constructor(e,t,i){super(e),this.predicate=t,this.inclusive=i,this.index=0}_next(e){const t=this.destination;let i;try{i=this.predicate(e,this.index++)}catch(s){return void t.error(s)}this.nextOrComplete(e,i)}nextOrComplete(e,t){const i=this.destination;Boolean(t)?i.next(e):(this.inclusive&&i.next(e),i.complete())}}},"Yg/i":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i("An66"),o=i("hCLc"),n=i("kZht");let r=(()=>{class e{}return e.\u0275mod=n.Ib({type:e}),e.\u0275inj=n.Hb({factory:function(t){return new(t||e)},imports:[[s.c,o.c],s.c,o.c]}),e})()},kKMY:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var s=i("kZht"),o=i("zNk5"),n=i("C4W8"),r=i("Tgqk"),a=i("phvz"),c=i("2OYx"),h=i("ruhk"),l=i("s7kB"),d=i("cJtj"),u=i("ENSU"),v=i("dlUx");let p=(()=>{class e{constructor(e,t,i,s,o,n,r,a,c,h,l){this.menuService=e,this.viewerService=t,this.viewerDataService=i,this.hotspotService=s,this.i18n=o,this.controlService=n,this.panoService=r,this.fontsService=a,this._sanitizer=c,this.differs=h,this.statsService=l,this.default_options={},h&&(this.differ=h.find([]).create(null))}get overlayHeight(){return this.viewerService.overlayHeight}get menu(){return this.menuService.menu}get activeMenuElem(){return this.menuService.activeMenuElem}get background(){return this.menu.common_color?this.panoService.commonColor.background:this.menu.background}get active_color(){return this.menu.common_color?this.panoService.commonColor.active_color:this.menu.active_color}get text_color(){return this.menu.common_color?this.panoService.commonColor.text_color:this.menu.text_color}get existMenuButton(){return this.controlService.control.menu_button}get existControlButton(){return this.controlService.control.scheme_button}get show(){return this.menuService.show}get menuClass(){return this.show?this.menu.area+" show":this.menu.area+" align-"+this.menu.align+" hide"}get editorMode(){return this.viewerService.editor}get activePano(){return this.viewerService.active}get panoramas(){return this.panoService.panoramas}get isLoadMenu(){return this.panoService.isLoadMenu}get galeryActiveIndex(){return this.menuService.galeryActiveIndex}get keyStarts(){return this.panoService.keyStarts}get active(){return this.viewerService.active}toggle(){this.menuService.toggle(),this.menuService.menu.hide_control&&(this.viewerDataService.controlWidgetVisible=!this.viewerDataService.controlWidgetVisible),this.menuService.menu.hide_scheme&&(this.viewerDataService.schemeWidgetVisible=!this.viewerDataService.schemeWidgetVisible),this.menuService.menu.hide_hotspot&&(this.viewerDataService.hotspotWidgetVisible=!this.viewerDataService.hotspotWidgetVisible)}checkActive(e){return!!e&&this.menuService.activeMenuElem==e}panoListColor(e){return"pano"==e.type&&this.checkActive(e.id)&&this.active_color?this.active_color.color:this.menu.panos_font&&this.menu.panos_font.color?this.menu.panos_font.color:this.text_color?this.text_color.color:"initial"}isActive(e){return!!e&&this.activeMenuElem==e}panoName(e){let t=this.panoService.getPanoById(e);return t?this.i18n.t(t.name):null}panoImg(e){let t=this.panoService.getPanoById(e);return t?t.url_preview:null}goToPano(e,t=null){this.viewerService.goToPano(e,t)}open(e,t){switch(t.type){case"pano":this.goToPano(t.pano,{theta:t.theta,phi:t.phi,fov:t.fov});let e=this.statsService.getWidget(this.menu.widget);this.statsService.send({plugin:e.name,type:e.key,details:t.pano.id});break;case"link":let i=this.linkHref(t.href).match(/1s(.*?)!2/);i&&-1!=["G1","G2"].indexOf(this.keyStarts)?this.viewerService.viewer.setPano(i[1]):window.open(this.linkHref(t.href),"_blank");break;case"hotspot":let s=this.getHotspotById(t.hotspot);this.viewerService.goToPano(s.pano,s.position),this.hotspotService.open(s.id)}t.children&&this.openDropdown(e),this.menuService.activeMenuElem=t.id}safeStyle(e){return this._sanitizer.bypassSecurityTrustStyle(e)}getHotspotById(e){return this.hotspotService.getHotspotById(e)}openDropdown(e){let t=this.getParent(e.target,"LI");if(t.classList.contains("open"))t.classList.remove("open"),this.slideUp(t.getElementsByTagName("ul")[0]);else{let e=this.getParent(t,"UL");Array.from(e.children).map(e=>{e.classList.contains("dropdown")&&e.classList.contains("open")&&(e.classList.remove("open"),this.slideUp(e.getElementsByTagName("ul")[0]))}),t.classList.add("open"),this.slideDown(t.getElementsByTagName("ul")[0])}}getParent(e,t){let i=e.parentElement;for(;i.tagName!=t;)i=i.parentElement;return i}slideDown(e,t=400){clearInterval(this.slideInterval),e.style.removeProperty("height"),e.style.position="absolute",e.style.visibility="hidden",e.style.display="block",e.style.overflow="hidden";let i=e.offsetHeight;e.style.removeProperty("position"),e.style.removeProperty("visibility"),e.style.height=0,e.style.transition="height "+t+"ms ease",setTimeout(()=>{e.style.height=i+"px",this.slideInterval=setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow")},t)})}slideUp(e,t=400){clearInterval(this.slideInterval),e.style.removeProperty("height"),e.style.height=e.offsetHeight+"px",e.style.overflow="hidden",e.style.transition="height "+t+"ms ease",setTimeout(()=>{e.style.height=0,this.slideInterval=setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.display="none"},t)})}getBgcStyles(e){return e?"gradient"==e.type?"radial"!=e.align?{background:"-webkit-linear-gradient("+e.align+", "+e.color+" 0%,"+e.color2+" 100%)"}:{background:"radial-gradient(at center center, "+e.color+" 0%,"+e.color2+" 100%)"}:{background:e.color}:null}resizeImg(e,t,i=!1){let s=e.split("?");return i&&(s[0]=s[0].replace(/.jpg|.jpeg|.png|.gif/gi,e=>"_thumb"+e)),s[1]="resize="+t+"&"+s[1],s.join("?")}fontStyle(e){return this.fontsService.fontStyle(e)}linkHref(e){return"string"==typeof e?e:this.i18n.t(e)}initData(){this.data?(this.checkDefaultDataUpdate(),this.menuService.init(this.data),this.menu.panos&&Array.isArray(this.menu.panos)&&this.recursiveChildrenPanoNameCheck(this.menu.panos)):(this.default_options.panos&&(this.default_options.panos=this.panoService.initTourId(this.default_options.panos)),this.checkDefaultDataText(),this.menuService.show=!0,this.menuService.init(this.default_options)),this.widgetInit=!0}checkDefaultDataText(){null!=this.default_options.title&&(this.default_options.title=this.i18n.toLangFormat(this.default_options.title)),null!=this.default_options.contact_title&&(this.default_options.contact_title=this.i18n.toLangFormat(this.default_options.contact_title)),null!=this.default_options.contact1&&(this.default_options.contact1=this.i18n.toLangFormat(this.default_options.contact1)),null!=this.default_options.contact2&&(this.default_options.contact2=this.i18n.toLangFormat(this.default_options.contact2)),null!=this.default_options.address_title&&(this.default_options.address_title=this.i18n.toLangFormat(this.default_options.address_title)),null!=this.default_options.address1&&(this.default_options.address1=this.i18n.toLangFormat(this.default_options.address1)),null!=this.default_options.address2&&(this.default_options.address2=this.i18n.toLangFormat(this.default_options.address2)),null!=this.default_options.pano_title&&(this.default_options.pano_title=this.i18n.toLangFormat(this.default_options.pano_title)),null!=this.default_options.gallery_arr&&this.default_options.gallery_arr.map(e=>{e.name=this.i18n.toLangFormat(e.name)})}checkDefaultDataUpdate(){this.checkDefaultDataText(),Object.keys(this.default_options).map(e=>{null==this.data[e]&&(this.getNewIdentificator()[e]=!0,this.data[e]=this.default_options[e])}),this.checkFontStyle()}getNewIdentificator(){return this.panoService.newIdentification.menu}updatePanoNames(e){e&&e.map(e=>{if("pano"==e.type&&!e.name){let t=this.panoService.getPanoById(e.pano);e.name=t.name}})}recursiveChildrenPanoNameCheck(e){this.updatePanoNames(e),e.map(e=>{e.children&&this.recursiveChildrenPanoNameCheck(e.children)})}checkFontStyle(){Object.keys(this.menu).map(e=>{e.endsWith("_font")&&this.menu[e]&&this.menu[e].family&&this.fontsService.loadFonts([this.menu[e].family])})}ngOnInit(){this.initData()}ngAfterContentInit(){}ngAfterViewInit(){}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(o.a),s.Kb(n.a),s.Kb(r.a),s.Kb(a.a),s.Kb(c.a),s.Kb(h.a),s.Kb(l.a),s.Kb(d.a),s.Kb(u.b),s.Kb(s.s),s.Kb(v.a))},e.\u0275cmp=s.Eb({type:e,selectors:[["menu-component"]],inputs:{data:"data"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})()},l9nd:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var s=i("kZht"),o=i("ruhk"),n=i("phvz"),r=i("2OYx"),a=i("C4W8"),c=i("Tgqk"),h=i("zNk5"),l=i("s7kB"),d=i("wKdx"),u=i("cJtj"),v=i("dlUx"),p=i("ENSU");let m=(()=>{class e{constructor(e,t,i,s,o,n,r,a,c,h,l){this.controlService=e,this.hotspotService=t,this.i18n=i,this.viewerService=s,this.viewerDataService=o,this.menuService=n,this.panoService=r,this.schemeService=a,this.fontsService=c,this.statsService=h,this.sanitizer=l,this.default_options={}}get panosFontStyle(){return this.fontsService.fontStyle(this.control.panos_font)}get soundSrc(){return this.control.tools.filter(e=>"sound"==e.key).pop().sound_src}toggle(){this.controlService.toggle()}nextPano(){this.viewerService.nextPano();let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"next"})}previousPano(){this.viewerService.previousPano();let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"previous"})}toggleFullscreen(){this.viewerService.toggleFullscreen();let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"full"})}toggleHotspot(){this.viewerService.toggleHotspot();let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"hotspots"})}toggleScheme(){this.viewerDataService.schemeWidgetVisible?this.schemeService.toggle():this.viewerDataService.schemeWidgetVisible=!0;let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"map"})}toggleSlider(){this.viewerService.slideInterval.angle?this.viewerService.slideStop():this.viewerService.slidePano();let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"play"})}toggleSound(){this.controlService.audioPlaying?this.controlService.pauseSound():this.controlService.playSound();let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"sound"})}bgcStyle(e){return e?this.sanitizer.bypassSecurityTrustStyle("gradient"==e.type?"radial"!=e.align?"-webkit-linear-gradient("+e.align+", "+e.color+" 0%,"+e.color2+" 100%)":"radial-gradient(at center center, "+e.color+" 0%,"+e.color2+" 100%)":e.color):null}toggleMenu(){this.menuService.toggle(),this.menuService.menu.hide_control&&(this.viewerDataService.controlWidgetVisible=!this.viewerDataService.controlWidgetVisible),this.menuService.menu.hide_scheme&&(this.viewerDataService.schemeWidgetVisible=!this.viewerDataService.schemeWidgetVisible),this.menuService.menu.hide_hotspot&&(this.viewerDataService.hotspotWidgetVisible=!this.viewerDataService.hotspotWidgetVisible);let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"menu"})}panoName(e){let t=this.panoService.getPanoById(e);return t?this.i18n.t(t.name):null}goToPano(e,t=null){this.viewerService.goToPano(e,t)}checkActive(e){return this.viewerService.active.id==e.id&&this.viewerService.active.t_id==e.t_id}panoImg(e){let t=this.panoService.getPanoById(e);return t?t.url.replace(".jpg","_thumb.jpg").replace("3000x1500","700x350"):null}fontStyle(e){return this.fontsService.fontStyle(e)}share(e){let t;if("linkedin"==e){t="https://www.linkedin.com/shareArticle?url=";let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"share_lk"})}else if("twitter"==e){t="https://twitter.com/intent/tweet?url=";let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"share_tw"})}else{t="https://www.facebook.com/sharer/sharer.php?u=";let e=this.statsService.getWidget(this.control.widget);this.statsService.send({plugin:e.name,type:e.key,details:"share_fb"})}t+=window.location.href,window.open(t,"Share","width=800,height=500,resizable,scrollbars=yes,status=1")}goToVrLink(){this.editorMode||window.open(`https://vr.tourmkr.app/?tour=${this.panoService.moderationUrl.substr(2)}&scene=${this.viewerDataService.active.id}&vr`)}openActivePanoPhoto(){let e=this.panoService.getPanoById(this.viewerService.active),t=e.id,i=e.url.split("?")[0].replace("https://img.gothru.org/","").replace("_thumb",""),s=this.viewerService.viewerWidth,o=this.viewerService.viewerHeight,n=parseInt(e.url.split("?")[1].replace("pad=bg:","")),r=Math.round(180*this.viewerService.viewer.scene().view().fov()/Math.PI/2),a=Math.round(this.viewerService.angle-e.north_angle);a<0&&(a+=360),a>=360&&(a-=360),window.open(`https://img.gothru.org/pano_zoom.php?p=${t}&i=${i}&w=${s}&h=${o}&a=${r}&y=${a}&v=${n}`)}checkDefaultDataText(){null!=this.default_options.tools&&this.default_options.tools.map(e=>{null!=e.inputs&&e.inputs.map(e=>{if("text"!=e.type&&"textarea"!=e.type||(e.value=this.i18n.toLangFormat(e.value)),"table"==e.type){let t=[];e.value.map(e=>{let i=[];e.map(e=>{i.push(this.i18n.toLangFormat(e))}),t.push(i)}),e.value=t}})})}checkDefaultDataUpdate(){Object.keys(this.default_options).map(e=>{null==this.data[e]&&(this.getNewIdentificator()[e]=!0,this.data[e]=this.default_options[e]),"tools"==e&&this.default_options[e].map(t=>{let i=this.data[e].filter(e=>e.key==t.key).pop();i?Object.keys(t).map(e=>{null==i[e]&&(i[e]=t[e])}):(t.visible=!1,this.data[e].push(t))})}),this.checkFontStyle()}getNewIdentificator(){return this.panoService.newIdentification.control}checkFontStyle(){this.controlService.control.tools&&this.controlService.control.tools.map(e=>{e.inputs&&e.inputs.map(e=>{"text"!=e.type&&"textarea"!=e.type||(e.font?e.font.family&&this.fontsService.loadFonts([e.font.family]):e.font={family:"",size:"",italic:!1,bold:!1,underline:!1,color:""})})}),Object.keys(this.controlService.control).map(e=>{e.endsWith("_font")&&this.controlService.control[e]&&this.controlService.control[e].family&&this.fontsService.loadFonts([this.controlService.control[e].family])})}initData(){var e=navigator.userAgent.toLowerCase();this.vrLinkShow=!!e.match(/(ipad|iphone|ipod|android)/g),this.data||this.checkDefaultDataText(),this.data?(this.checkDefaultDataUpdate(),this.controlService.init(this.data),this.control=this.controlService.control):(this.controlService.init(this.default_options),this.controlService.show=!0),this.control=this.controlService.control,this.scheme=this.schemeService.scheme,this.menu=this.menuService.menu,this.slideInterval=this.viewerService.slideInterval,this.keyStarts=this.panoService.keyStarts,this.shareUrl=this.controlService.shareUrl,this.editorMode=this.viewerService.editor,this.commonColor=this.panoService.commonColor,this.backgroundStatic=this.bgcStyle(this.control.common_color?this.commonColor.background:this.control.background),this.activeColorStatic=this.bgcStyle(this.control.common_color?this.commonColor.active_color:this.control.active_color),this.panosFontStyleStatic=this.fontsService.fontStyle(this.control.panos_font),this.widgetInit=!0}ngOnInit(){this.initData()}ngAfterContentInit(){}ngAfterViewInit(){this.controlService.loadSound()}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(o.a),s.Kb(n.a),s.Kb(r.a),s.Kb(a.a),s.Kb(c.a),s.Kb(h.a),s.Kb(l.a),s.Kb(d.a),s.Kb(u.a),s.Kb(v.a),s.Kb(p.b))},e.\u0275cmp=s.Eb({type:e,selectors:[["control-component"]],inputs:{data:"data"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})()},oKCH:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var s=i("kZht"),o=i("C4W8"),n=i("wKdx"),r=i("dlUx"),a=i("2OYx"),c=i("s7kB"),h=i("ENSU"),l=i("cJtj");let d=(()=>{class e{constructor(e,t,i,s,o,n,r){this.viewerService=e,this.schemeService=t,this.statsService=i,this.i18n=s,this.panoService=o,this.sanitizer=n,this.fontsService=r,this.default_options={}}bgcStyle(e){return e?this.sanitizer.bypassSecurityTrustStyle("gradient"==e.type?"radial"!=e.align?"-webkit-linear-gradient("+e.align+", "+e.color+" 0%,"+e.color2+" 100%)":"radial-gradient(at center center, "+e.color+" 0%,"+e.color2+" 100%)":e.color):null}toggle(){this.schemeService.toggle()}checkDefaultDataUpdate(){Object.keys(this.default_options).map(e=>{-1==["image","map_angle","dots","dot_size"].indexOf(e)&&null==this.data[e]&&(this.getNewIdentificator()[e]=!0,this.data[e]=this.default_options[e])}),this.checkFontStyle()}getNewIdentificator(){return this.panoService.newIdentification.scheme}checkFontStyle(){Object.keys(this.schemeService.scheme).map(e=>{e.endsWith("_font")&&this.schemeService.scheme[e]&&this.schemeService.scheme[e].family&&this.fontsService.loadFonts([this.schemeService.scheme[e].family])})}initData(){this.data?(this.checkDefaultDataUpdate(),this.schemeService.init(this.data)):(this.schemeService.show=!0,this.schemeService.init(this.default_options)),"mobile"==this.viewerService.overlayDeviceClass&&(this.schemeService.show=!1),this.scheme=this.schemeService.scheme,this.editorMode=this.viewerService.editor,this.activePano=this.viewerService.active,this.commonColor=this.panoService.commonColor,this.backgroundStatic=this.bgcStyle(this.schemeService.scheme.common_color?this.commonColor.background:this.schemeService.scheme.background),this.activeColorStatic=this.bgcStyle(this.schemeService.scheme.common_color?this.commonColor.active_color:this.schemeService.scheme.active_color),this.dotBackgroundStatic=this.bgcStyle(this.schemeService.scheme.dot_background),this.widgetInit=!0}ngOnInit(){this.initData()}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(o.a),s.Kb(n.a),s.Kb(r.a),s.Kb(a.a),s.Kb(c.a),s.Kb(h.b),s.Kb(l.a))},e.\u0275cmp=s.Eb({type:e,selectors:[["scheme-component"]],inputs:{data:"data"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})()}}]);